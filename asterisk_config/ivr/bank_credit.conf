[bank_credit]
exten => s,1,Answer()
same => n,Playback(welcome_message) ; Mensaje de bienvenida
same => n,Background(please-select) ; Reproduce las opciones
same => n,WaitExten(10)

; Opción 1 - Ventas
exten => 1,1,Playback(enter-your-pin)
same => n,Read(pin,,4) ; Solicitar el PIN de 4 dígitos
same => n,Set(Result=invalid) ; Inicializar la variable Result
same => n,UserEvent(PinValidation,PIN:${pin},Department:sales) ; Enviar evento a AMI para validar el PIN
same => n,Wait(2) ; Esperar respuesta del AMI
same => n,GotoIf($["${Result}" = "valid"]?sales) ; Si es válido, continuar
same => n,Playback(invalid-pin)
same => n,Hangup()

; Opción 2 - Servicio al cliente
exten => 2,1,Playback(enter-your-pin)
same => n,Read(pin,,4)
same => n,Set(Result=invalid) ; Inicializar la variable Result
same => n,UserEvent(PinValidation,PIN:${pin},Department:customer_service) ; Validar PIN para servicio al cliente
same => n,Wait(2)
same => n,GotoIf($["${Result}" = "valid"]?customer_service)
same => n,Playback(invalid-pin)
same => n,Hangup()

; Opción 3 - Hablar con representante
exten => 3,1,Dial(PJSIP/1001) ; Transferir la llamada a la extensión 1001 usando PJSIP

; Manejo de errores
exten => i,1,Playback(invalid-option)
exten => t,1,Playback(timeout)

[sales]
exten => s,1,Playback(sales-department)

[customer_service]
exten => s,1,Playback(customer-service)
