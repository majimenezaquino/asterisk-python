;-------------------------------- PrivateDial ----------------------------------
; Configuraci√≥n de Asterisk para SignalWire

[global]
type = global
nat=yes
user_agent = Platform PBX

;-------------------------------- Transport -------------------------------------
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060
external_signaling_address=192.168.80.77
external_media_address=192.168.80.77

[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5060
external_signaling_address=192.168.80.77
external_media_address=192.168.80.77

[transport-tls]
type=transport
protocol=tls
bind=0.0.0.0:5061
external_signaling_address=192.168.80.77
external_media_address=192.168.80.77
cert_file=/etc/ssl/asterisk/cert.pem
priv_key_file=/etc/ssl/asterisk/priv_key.pem
method=tlsv1_2

;-------------------------------- Trunk de SignalWire ---------------------------

[outbound_trunk]
type=registration
outbound_auth=auth_outbound_trunk
server_uri=sip:ogtic-1b956a4de4db.sip.signalwire.com
client_uri=sip:jmecatroni@ogtic-1b956a4de4db.sip.signalwire.com
retry_interval=60
forbidden_retry_interval=600
expiration=3600
auth_rejection_permanent=no

[auth_outbound_trunk]
type=auth
auth_type=userpass
username=jmecatroni
password=Mja25192519.

[outbound_trunk_endpoint]
type=endpoint
transport=transport-udp,transport-tcp,transport-tls  ; Utilizando los tres transportes
context=from-internal
disallow=all
allow=ulaw,alaw,g729  ; Agregar codecs compatibles
aors=outbound_trunk_aor

[outbound_trunk_aor]
type=aor
contact=sip:ogtic-1b956a4de4db.sip.signalwire.com

;-------------------------------- Endpoint para solicitudes OPTIONS de SignalWire --------------

[signalwire_options]
type=endpoint
transport=transport-udp
context=from-external
disallow=all
allow=ulaw
aors=signalwire_aor
match=ogtic-1b956a4de4db.sip.signalwire.com

[signalwire_aor]
type=aor
contact=sip:ogtic-1b956a4de4db.sip.signalwire.com

;-------------------------------- Extensiones SIP --------------------------------
[1001]
type=endpoint
context=internal
disallow=all
allow=ulaw
auth=auth1001
aors=1001

[auth1001]
type=auth
auth_type=userpass
username=1001
password=1234

[1001]
type=aor
max_contacts=1

[1002]
type=endpoint
context=internal
disallow=all
allow=ulaw
auth=auth1002
aors=1002

[auth1002]
type=auth
auth_type=userpass
username=1002
password=1234

[1002]
type=aor
max_contacts=1

[1003]
type=endpoint
context=internal
disallow=all
allow=ulaw
auth=auth1003
aors=1003

[auth1003]
type=auth
auth_type=userpass
username=1003
password=1234

[1003]
type=aor
max_contacts=1
